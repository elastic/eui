// Because of the animations and positioning involved, this code gets pretty
// repetitive. What you generally need to know if you work in here is that
// the positioning of the popovers (and the arrows attached to them)
// is handled through absolute positioning and then animated through the use
// of transforms.

.euiPopover {
  display: inline-block;
  position: relative;
  vertical-align: middle;
  max-width: 100%;
}

.euiPopover__anchor {
  display: inline-block;
}

/**
 * 1. Can expand further, but it looks weird if it's smaller than the originating button.
 * 2. Animation happens on the panel.
 */
.euiPopover__panel {
  position: absolute;
  z-index: $euiZContentMenu;
  min-width: $euiButtonMinWidth; /* 1 */
  backface-visibility: hidden;
  pointer-events: none;
  transition: /* 2 */
    opacity $euiAnimSlightBounce $euiAnimSpeedSlow,
    visibility $euiAnimSlightBounce $euiAnimSpeedSlow,
    transform $euiAnimSlightBounce $euiAnimSpeedSlow;
  opacity: 0; /* 2 */
  visibility: hidden; /* 2 */
  transform: translateY(0) translateZ(0); /* 2 */

  &.euiPopover__panel-isOpen {
    opacity: 1;
    visibility: visible;
    pointer-events: auto;
  }

  // This fakes a border on the arrow.
  &:before {
    position: absolute;
    content: "";
    height: 0;
    width: 0;
  }

  // This part of the arrow matches the panel.
  &:after {
    position: absolute;
    content: "";
    height: 0;
    width: 0;
  }

  .euiPopover__panel__arrow {
    position: absolute;
    width: 0;
    height: 0;

    // This fakes a border on the arrow.
    &:before {
      position: absolute;
      content: "";
      height: 0;
      width: 0;
    }

    // This part of the arrow matches the panel.
    &:after {
      position: absolute;
      content: "";
      height: 0;
      width: 0;
    }

    &.euiPopover__panel__arrow-top {
      &:before {
        bottom: -$euiSize + 1;
        border-left: $euiSize solid transparent;
        border-right: $euiSize solid transparent;
        border-top: $euiSize solid $euiBorderColor;
      }

      &:after {
        bottom: -$euiSize + 2;
        border-left: $euiSize solid transparent;
        border-right: $euiSize solid transparent;
        border-top: $euiSize solid $euiColorEmptyShade;
      }
    }

    &.euiPopover__panel__arrow-right {
      &:before {
        left: -$euiSize;
        top: 50%;
        border-top: $euiSize solid transparent;
        border-bottom: $euiSize solid transparent;
        border-right: $euiSize solid $euiBorderColor;
      }

      &:after {
        left: -$euiSize + 1;
        top: 50%;
        border-top: $euiSize solid transparent;
        border-bottom: $euiSize solid transparent;
        border-right: $euiSize solid $euiColorEmptyShade;
      }
    }

    &.euiPopover__panel__arrow-bottom {
      &:before {
        top: -$euiSize;
        border-left: $euiSize solid transparent;
        border-right: $euiSize solid transparent;
        border-bottom: $euiSize solid $euiBorderColor;
      }

      &:after {
        top: -$euiSize + 1;
        border-left: $euiSize solid transparent;
        border-right: $euiSize solid transparent;
        border-bottom: $euiSize solid $euiColorEmptyShade;
      }
    }

    &.euiPopover__panel__arrow-left {
      &:before {
        right: -$euiSize + 1;
        top: 50%;
        border-top: $euiSize solid transparent;
        border-bottom: $euiSize solid transparent;
        border-left: $euiSize solid $euiBorderColor;
      }

      &:after {
        right: -$euiSize + 2;
        top: 50%;
        border-top: $euiSize solid transparent;
        border-bottom: $euiSize solid transparent;
        border-left: $euiSize solid $euiColorEmptyShade;
      }
    }
  }
}

.euiPopover__panel.euiPopover__panel-isOpen.euiPopover--anchorUpCenter,
.euiPopover__panel.euiPopover__panel-isOpen.euiPopover--anchorUpLeft,
.euiPopover__panel.euiPopover__panel-isOpen.euiPopover--anchorUpRight
{
  transform: translateY($euiSizeS) translateZ(0);
}

// Anchor DOWN
// Anchor DOWN
// Anchor DOWN
// Anchor DOWN
// Anchor DOWN

.euiPopover__panel.euiPopover__panel-withTitle {
  .euiPopover__panel__arrow {
    &.euiPopover__panel__arrow-bottom:after {
      border-bottom-color: $euiColorLightestShade;
    }

    &.euiPopover__panel__arrow-right:after {
      border-right-color: $euiColorLightestShade;
    }

    &.euiPopover__panel__arrow-left:after {
      border-left-color: $euiColorLightestShade;
    }
  }
}

.euiPopover__panel.euiPopover__panel-isOpen.euiPopover--anchorDownCenter,
.euiPopover__panel.euiPopover__panel-isOpen.euiPopover--anchorDownLeft,
.euiPopover__panel.euiPopover__panel-isOpen.euiPopover--anchorDownRight
{
  transform: translateY(-$euiSizeS) translateZ(0);
}

// Anchor LEFT
// Anchor LEFT
// Anchor LEFT
// Anchor LEFT
// Anchor LEFT

.euiPopover--withTitle.euiPopover--anchorLeftCenter .euiPopover__panel:after,
.euiPopover--withTitle.euiPopover--anchorLeftUp .euiPopover__panel:after,
.euiPopover--withTitle.euiPopover--anchorLeftDown .euiPopover__panel:after
{
  border-left-color: $euiColorLightestShade;
}

.euiPopover--withTitle.euiPopover--anchorLeftUp .euiPopover__panel {
  top: 0;

  &:before {
    top: $euiSizeXS;
  }

  &:after {
    top: $euiSizeXS;
  }
}

.euiPopover__panel.euiPopover__panel-isOpen.euiPopover--anchorLeftCenter,
.euiPopover__panel.euiPopover__panel-isOpen.euiPopover--anchorLeftUp,
.euiPopover__panel.euiPopover__panel-isOpen.euiPopover--anchorLeftDown
{
  transform: translateX($euiSizeS) translateZ(0);
}

// Anchor RIGHT
// Anchor RIGHT
// Anchor RIGHT
// Anchor RIGHT
// Anchor RIGHT

.euiPopover--withTitle.euiPopover--anchorRightCenter .euiPopover__panel:after,
.euiPopover--withTitle.euiPopover--anchorRightUp .euiPopover__panel:after,
.euiPopover--withTitle.euiPopover--anchorRightDown .euiPopover__panel:after
{
  border-right-color: $euiColorLightestShade;
}

.euiPopover--withTitle.euiPopover--anchorRightUp .euiPopover__panel {
  top: 0;

  &:before {
    top: $euiSizeXS;
  }

  &:after {
    top: $euiSizeXS;
  }
}


.euiPopover__panel.euiPopover__panel-isOpen.euiPopover--anchorRightCenter,
.euiPopover__panel.euiPopover__panel-isOpen.euiPopover--anchorRightUp,
.euiPopover__panel.euiPopover__panel-isOpen.euiPopover--anchorRightDown
{
  transform: translateX(-$euiSizeS) translateZ(0);
}
