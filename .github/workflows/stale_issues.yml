name: 'Close stale issues and PRs'
on:
  schedule:
    - cron: '0 */8 * * *'

permissions:
  contents: read

jobs:
  stale:
    permissions:
      issues: write  # for actions/stale to close stale issues
      pull-requests: write  # for actions/stale to close stale PRs
    runs-on: ubuntu-latest
    steps:
      - uses: actions/stale@v3
        with:
          stale-issue-message: 'üëã Hey there. This issue hasn''t had any activity for 180 days. We''ll automatically close it if that trend continues for another week. If you feel this issue is still valid and needs attention please let us know with a comment.'
          stale-pr-message: 'üëã Hey there. This PR hasn''t had any activity for 90 days. We''ll automatically close it if that trend continues for another week. If you feel this issue is still valid and needs attention please let us know with a comment.'
          close-issue-message: '‚ùå We''re automatically closing this issue due to lack of activity. Please comment if you feel this was done in error.'
          close-pr-message: '‚ùå We''re automatically closing this PR due to lack of activity. Please comment if you feel this was done in error.'
          days-before-pr-stale: 90
          days-before-issue-stale: 180
          days-before-close: 7
          stale-issue-label: 'stale-issue'
          close-issue-label: 'stale-issue-closed'
          exempt-issue-labels: 'bug,skip-stale-check,meta'
          stale-pr-label: 'stale-pr'
          close-pr-label: 'stale-pr-closed'
          exempt-pr-labels: 'skip-stale-check,meta'
          exempt-all-assignees: true
          operations-per-run: 1000
          remove-stale-when-updated: true
          enable-statistics: true
          debug-only: false
  answered: # automatically close issues labeled as 'answered' if there was no response in 3 days
    permissions:
      issues: write
    runs-on: ubuntu-latest
    steps:
      - uses: actions/stale@v3
        with:
          days-before-stale: -1 # the label should be manually applied
          days-before-close: 3
          only-issue-labels: 'answered'
          stale-issue-label: 'answered'
          remove-stale-when-updated: true
          stale-issue-message: ''
          close-issue-message: 'üëã This issue hasn''t seen activity in 3 days, so we''re automatically closing this issue as answered. Please leave a comment if that''s not the case, or if you have any remaining questions or issues.'
          operations-per-run: 1000
          enable-statistics: true
          debug-only: false
